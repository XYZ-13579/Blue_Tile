<!DOCTYPE html>
<html>
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
</head>
<body>
<style>
      body::-webkit-scrollbar {
    width: 0;      /* 横スクロールバーの幅を0に */
    height: 0;     /* 縦スクロールバーも0にしたい場合 */
}
     html, body {
            margin: 0;
            padding: 0;
         
        }

</style>
  <script>
let forms = [];
let offset = 50;

function setup() {
  createCanvas(windowWidth, windowHeight);
  rectMode(CENTER);
  divideRect(offset, offset, width - offset * 2, height - offset * 2, width * 0.07);
  shuffle(forms, true);
}

function draw() {
  background(0); 
  for (let i = 0; i < forms.length; i++) {
    forms[i].run();
  }
}

function divideRect(x, y, w, h, min) {
  if (w > min || h > min) {
    if (w >= h) {
      let rndw = random(0.1, 0.9) * w;
      divideRect(x, y, rndw, h, min);
      divideRect(x + rndw, y, w - rndw, h, min);
    }
    if (w < h) {
      let rndh = random(0.1, 0.9) * h;
      divideRect(x, y, w, rndh, min);
      divideRect(x, y + rndh, w, h - rndh, min);
    }
  } else {
    forms.push(new Form(x + w / 2, y + h / 2, w, h));
  }
}

function easeInOutQuart(t) {
  if ((t /= 0.5) < 1) return 0.5 * t * t * t * t;
  return -0.5 * ((t -= 2) * t * t * t - 2);
}

class Form {
  constructor(x, y, w, h) {
    this.x = x;
    this.y = y;
    this.w = w;
    this.h = h;
    this.x0 = x;
    this.y0 = y;
    this.x1 = x;
    this.y1 = y;
    this.setup();
  }

  show() {
    stroke(255); // 枠線を白に変更
    strokeWeight(1); // 枠線の太さを調整（必要に応じて変更可能）
    fill(0, 100, 255, 127); // 半透明の青（RGBA: 0, 100, 255, 0.5）
    rect(this.x, this.y, this.w, this.h);
  }

  move() {
    this.checkTheDirection();
    if (0 < this.t && this.t < this.t1) {
      let amt = map(this.t, 0, this.t1 - 1, 0, 1);
      let ease = easeInOutQuart(amt);
      this.x = lerp(this.x0, this.x1, ease);
      this.y = lerp(this.y0, this.y1, ease);
    } else if (this.t2 < this.t && this.t < this.t3) {
      let amt = map(this.t, this.t2, this.t3 - 1, 0, 1);
      let ease = easeInOutQuart(amt);
      this.x = lerp(this.x1, this.x0, ease);
      this.y = lerp(this.y1, this.y0, ease);
    } else if (this.t4 < this.t) {
      this.setup();
    }
    this.t++;
  }

  setup() {
    let maxDelay = 400;
    let delay = int(random(maxDelay));
    this.direction = int(random(4));
    this.t = 0 - delay;
    this.t1 = 80;
    this.t2 = this.t1 + 0 + (maxDelay - delay) * 0.2;
    this.t3 = this.t2 + 80;
    this.t4 = this.t3 + 20 + (maxDelay - delay) * 0.8;
    this.mlt = int(random(1, 6));
  }

  checkTheDirection() {
    if (this.direction == 0) {
      this.x1 = this.x0 + this.w * this.mlt;
      this.y1 = this.y0;
    } else if (this.direction == 1) {
      this.x1 = this.x0 - this.w * this.mlt;
      this.y1 = this.y0;
    } else if (this.direction == 2) {
      this.x1 = this.x0;
      this.y1 = this.y0 + this.h * this.mlt;
    } else {
      this.x1 = this.x0;
      this.y1 = this.y0 - this.h * this.mlt;
    }
  }

  run() {
    this.show();
    this.move();
  }
}   
  </script>  
  
